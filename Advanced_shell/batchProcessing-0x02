#!/bin/bash

# List of Pokémon in lowercase
POKEMON_LIST=("bulbasaur" "ivysaur" "venusaur" "charmander" "charmeleon")

# Base API endpoint
BASE_URL="https://pokeapi.co/api/v2/pokemon"

# Max retries per Pokémon
MAX_RETRIES=3

# Clear previous error log
> errors.txt

# Loop through Pokémon
for name in "${POKEMON_LIST[@]}"; do
    echo "Fetching data for $name..."
    attempt=1
    success=0

    while [ $attempt -le $MAX_RETRIES ]; do
        # Fetch data and save to file
        curl -s -f -o "${name}.json" "${BASE_URL}/${name}"

        if [ $? -eq 0 ]; then
            echo "Saved ${name}.json"
            success=1
            break
        else
            echo "Attempt $attempt failed for $name."
            sleep 2  # Backoff delay
            ((attempt++))
        fi
    done

    # If all attempts failed
    if [ $success -eq 0 ]; then
        echo "Failed to fetch data for $name after $MAX_RETRIES attempts." | tee -a errors.txt
        rm -f "${name}.json"  # Remove any incomplete file
    fi

    # Rate limiting delay
    sleep 2
done

