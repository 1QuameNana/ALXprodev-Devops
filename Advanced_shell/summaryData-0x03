#!/bin/bash

# Output file
REPORT_FILE="pokemon_report.csv"

# Create CSV header
echo "Name,Height (dm),Weight (hg)" > "$REPORT_FILE"

# Loop through JSON files
for file in *.json; do
    # Extract data using jq
    name=$(jq -r '.name' "$file")
    height=$(jq -r '.height' "$file")
    weight=$(jq -r '.weight' "$file")

    # Capitalize first letter of name using sed
    name=$(echo "$name" | sed 's/.*/\u&/')

    # Append to CSV
    echo "$name,$height,$weight" >> "$REPORT_FILE"
done

# Display the CSV file
echo "Generated Report:"
cat "$REPORT_FILE"

# Calculate averages using awk
echo ""
echo "Averages:"
awk -F',' 'NR > 1 {
    total_height += $2;
    total_weight += $3;
    count++
} END {
    if (count > 0) {
        printf "Average Height: %.2f dm\n", total_height / count
        printf "Average Weight: %.2f hg\n", total_weight / count
    } else {
        print "No data found."
    }
}' "$REPORT_FILE"

